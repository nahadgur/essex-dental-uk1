const fs = require('fs');

// Essex locations - 42 towns
const locations = [
  "Basildon", "Billericay", "Braintree", "Brentwood", "Burnham-on-Crouch",
  "Canvey Island", "Chelmsford", "Chigwell", "Clacton-on-Sea", "Colchester",
  "Epping", "Frinton-on-Sea", "Grays", "Harlow", "Harwich",
  "Leigh-on-Sea", "Maldon", "Rayleigh", "Rochford", "Saffron Walden",
  "South Benfleet", "Southend-on-Sea", "Stanford-le-Hope", "Tilbury",
  "Walton-on-the-Naze", "West Mersea", "Witham", "Wivenhoe",
  "Alresford", "Brightlingsea", "Buckhurst Hill", "Coggeshall", "Dedham",
  "Great Dunmow", "Halstead", "Manningtree", "Pitsea", "Thaxted",
  "Waltham Abbey", "Westcliff-on-Sea", "Wickford"
];

// Services
const services = [
  'single-tooth',
  'multiple-teeth',
  'full-arch',
  'bone-grafting',
  'immediate-implants',
  'implant-dentures'
];

// Helper function to create URL-safe slugs
function slugify(text) {
  return text
    .toLowerCase()
    .replace(/\s+/g, '-')
    .replace(/[^\w-]+/g, '');
}

// Generate sitemap XML
function generateSitemap() {
  const baseUrl = 'https://essexdentalimplants.com'; // Update this to your actual domain
  const today = new Date().toISOString().split('T')[0];
  
  let sitemap = `<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
  
  <!-- Homepage -->
  <url>
    <loc>${baseUrl}</loc>
    <lastmod>${today}</lastmod>
    <changefreq>weekly</changefreq>
    <priority>1.0</priority>
  </url>

  <!-- Main Services Page -->
  <url>
    <loc>${baseUrl}/services</loc>
    <lastmod>${today}</lastmod>
    <changefreq>weekly</changefreq>
    <priority>0.9</priority>
  </url>

  <!-- Main Locations Page -->
  <url>
    <loc>${baseUrl}/location</loc>
    <lastmod>${today}</lastmod>
    <changefreq>weekly</changefreq>
    <priority>0.9</priority>
  </url>

  <!-- Blog Main Page -->
  <url>
    <loc>${baseUrl}/blog</loc>
    <lastmod>${today}</lastmod>
    <changefreq>weekly</changefreq>
    <priority>0.8</priority>
  </url>

`;

  // Individual Service Pages
  services.forEach(service => {
    sitemap += `  <!-- Service: ${service} -->
  <url>
    <loc>${baseUrl}/services/${service}</loc>
    <lastmod>${today}</lastmod>
    <changefreq>monthly</changefreq>
    <priority>0.8</priority>
  </url>

`;
  });

  // Individual Location Pages (Essex towns)
  locations.forEach(location => {
    const slug = slugify(location);
    sitemap += `  <!-- Location: ${location} -->
  <url>
    <loc>${baseUrl}/location/${slug}</loc>
    <lastmod>${today}</lastmod>
    <changefreq>monthly</changefreq>
    <priority>0.7</priority>
  </url>

`;
  });

  // Service √ó Location Pages (252 pages: 6 services √ó 42 locations)
  services.forEach(service => {
    locations.forEach(location => {
      const locationSlug = slugify(location);
      sitemap += `  <url>
    <loc>${baseUrl}/services/${service}/${locationSlug}</loc>
    <lastmod>${today}</lastmod>
    <changefreq>monthly</changefreq>
    <priority>0.6</priority>
  </url>
`;
    });
  });

  sitemap += `
</urlset>`;

  return sitemap;
}

// Write sitemap to file
const sitemapContent = generateSitemap();
fs.writeFileSync('./public/sitemap.xml', sitemapContent);

console.log('‚úÖ Sitemap generated successfully!');
console.log(`üìç Total Essex locations: ${locations.length}`);
console.log(`ü¶∑ Total services: ${services.length}`);
console.log(`üìÑ Total Service √ó Location pages: ${services.length * locations.length}`);
console.log(`üìä Total URLs in sitemap: ${6 + services.length + locations.length + (services.length * locations.length)}`);
console.log('üíæ Saved to: public/sitemap.xml');
