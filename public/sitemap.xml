const fs = require('fs');

// Essex locations - 42 towns
const locations = [
  "Basildon", "Billericay", "Braintree", "Brentwood", "Burnham-on-Crouch",
  "Canvey Island", "Chelmsford", "Chigwell", "Clacton-on-Sea", "Colchester",
  "Epping", "Frinton-on-Sea", "Grays", "Harlow", "Harwich",
  "Leigh-on-Sea", "Maldon", "Rayleigh", "Rochford", "Saffron Walden",
  "South Benfleet", "Southend-on-Sea", "Stanford-le-Hope", "Tilbury",
  "Walton-on-the-Naze", "West Mersea", "Witham", "Wivenhoe",
  "Alresford", "Brightlingsea", "Buckhurst Hill", "Coggeshall", "Dedham",
  "Great Dunmow", "Halstead", "Manningtree", "Pitsea", "Thaxted",
  "Waltham Abbey", "Westcliff-on-Sea", "Wickford"
];

// Services
const services = [
  'single-tooth',
  'multiple-teeth',
  'full-arch',
  'bone-grafting',
  'immediate-implants',
  'implant-dentures'
];

// Helper function to create URL-safe slugs
function slugify(text) {
  return text
    .toLowerCase()
    .replace(/\s+/g, '-')
    .replace(/[^\w-]+/g, '');
}

// Generate sitemap XML
function generateSitemap() {
  const baseUrl = 'https://essexdentalimplants.com'; // Update this to your actual domain
  const today = new Date().toISOString().split('T')[0];
  
  const urls = [];
  
  // Homepage
  urls.push({
    loc: baseUrl,
    lastmod: today,
    changefreq: 'weekly',
    priority: '1.0'
  });

  // Main Services Page
  urls.push({
    loc: `${baseUrl}/services`,
    lastmod: today,
    changefreq: 'weekly',
    priority: '0.9'
  });

  // Main Locations Page
  urls.push({
    loc: `${baseUrl}/location`,
    lastmod: today,
    changefreq: 'weekly',
    priority: '0.9'
  });

  // Blog Main Page
  urls.push({
    loc: `${baseUrl}/blog`,
    lastmod: today,
    changefreq: 'weekly',
    priority: '0.8'
  });

  // Individual Service Pages
  services.forEach(service => {
    urls.push({
      loc: `${baseUrl}/services/${service}`,
      lastmod: today,
      changefreq: 'monthly',
      priority: '0.8'
    });
  });

  // Individual Location Pages
  locations.forEach(location => {
    const slug = slugify(location);
    urls.push({
      loc: `${baseUrl}/location/${slug}`,
      lastmod: today,
      changefreq: 'monthly',
      priority: '0.7'
    });
  });

  // Service Ã— Location Pages
  services.forEach(service => {
    locations.forEach(location => {
      const locationSlug = slugify(location);
      urls.push({
        loc: `${baseUrl}/services/${service}/${locationSlug}`,
        lastmod: today,
        changefreq: 'monthly',
        priority: '0.6'
      });
    });
  });

  // Build XML
  let sitemap = '<?xml version="1.0" encoding="UTF-8"?>\n';
  sitemap += '<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">\n';
  
  urls.forEach(url => {
    sitemap += '  <url>\n';
    sitemap += `    <loc>${url.loc}</loc>\n`;
    sitemap += `    <lastmod>${url.lastmod}</lastmod>\n`;
    sitemap += `    <changefreq>${url.changefreq}</changefreq>\n`;
    sitemap += `    <priority>${url.priority}</priority>\n`;
    sitemap += '  </url>\n';
  });
  
  sitemap += '</urlset>';

  return sitemap;
}

// Write sitemap to file
const sitemapContent = generateSitemap();
fs.writeFileSync('./public/sitemap.xml', sitemapContent);

console.log('âœ… Sitemap generated successfully!');
console.log(`ğŸ“ Total Essex locations: ${locations.length}`);
console.log(`ğŸ¦· Total services: ${services.length}`);
console.log(`ğŸ“„ Total Service Ã— Location pages: ${services.length * locations.length}`);
console.log(`ğŸ“Š Total URLs in sitemap: ${4 + services.length + locations.length + (services.length * locations.length)}`);
console.log('ğŸ’¾ Saved to: public/sitemap.xml');
